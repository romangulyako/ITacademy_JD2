<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
         https://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-4.2.xsd">

    <changeSet id="add-cities-table" author="Roman Gulyako">
        <createTable tableName="cities">
            <column name="id" type="bigint" autoIncrement="true">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="name" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="location" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>

    <changeSet id="1630434626" author="Roman Gulyako" context="dev2">
        <sql>
            create table if not exists users(
                                                id serial primary key,
                                                user_name VARCHAR(16) NOT NULL UNIQUE,
                password VARCHAR(255) NOT NULL
                );
        </sql>
    </changeSet>

    <changeSet id="1630434640" author="Roman Gulyako" context="dev3">
        <sql>
            INSERT INTO users (id, user_name, password)
            VALUES ('1', 'admin', '$2y$12$kjBEvSNH8oN9508Vi8gpLOxzxsfc7H/HLRTQatlR4z3JOzrC4YXB6');

            INSERT INTO users (id, user_name, password)
            VALUES ('2', 'user', '$2y$12$kjBEvSNH8oN9508Vi8gpLOxzxsfc7H/HLRTQatlR4z3JOzrC4YXB6');
        </sql>
    </changeSet>
    <changeSet id="1630434641" author="Roman Gulyako" context="dev3">
        <sql>
            create table if not exists  roles(
                                                 id serial primary key,
                                                 name VARCHAR(45) NOT NULL
                );
        </sql>
    </changeSet>

    <changeSet id="1630434642" author="Roman Gulyako" context="dev4">
        <sql>
            INSERT INTO roles (id, name) VALUES( '1', 'USER');
            INSERT INTO roles (id, name) VALUES( '2', 'ADMIN');
        </sql>
    </changeSet>

    <changeSet id="1630434643" author="Roman Gulyako">
        <sql>
            create table if not exists  user_role(
                                                     user_id bigint unsigned NOT NULL,
                                                     role_id bigint unsigned NOT NULL,
                                                     FOREIGN KEY (user_id) REFERENCES users (id),
                FOREIGN KEY (role_id) REFERENCES roles (id)
                );
        </sql>
    </changeSet>

    <changeSet id="1630434644" author="Roman Gulyako">
        <sql>
            INSERT INTO user_role (user_id, role_id) VALUES('1', '2');
            INSERT INTO user_role (user_id, role_id) VALUES('2', '1');
        </sql>
    </changeSet>

</databaseChangeLog>